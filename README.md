# test2



&НаКлиенте
Процедура СделатьФото(Команда)
	
		Если СредстваМультимедиа.ПоддерживаетсяФотоснимок() Тогда
			ДанныеМультимедиа = СредстваМультимедиа.СделатьФотоснимок();
			Если ДанныеМультимедиа <> Неопределено Тогда
				ТекущееФото = ДанныеМультимедиа.ПолучитьДвоичныеДанные();
				Фото = ПоместитьВоВременноеХранилище(ТекущееФото, Новый УникальныйИдентификатор);
				УстановитьКартинку();
			КонецЕсли;
		Иначе    
			Сообщить(НСтр("ru = 'Съемка фото не поддерживается.'", "ru"));
		КонецЕсли; 
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьКартинку(Команда)
	НачатьПомещениеФайла(Новый ОписаниеОповещения("ЗавершениеПомещенияФайла",ЭтотОбъект));
КонецПроцедуры

Процедура ЗавершениеПомещенияФайла(Результат, Адрес, ВыбранноеИмяФайла, ДополнительныеПараметры) Экспорт 
	
	Если Результат Тогда
		Фото = Адрес;
		УстановитьКартинку();
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура УстановитьКартинку()

	НовыйФайлКартинки = Справочники.Фото.СоздатьЭлемент();
	НовыйФайлКартинки.Файл = Новый ХранилищеЗначения(ПолучитьИзВременногоХранилища(Фото));
	
	НовыйФайлКартинки.Записать();
	
	Фото = ПоместитьВоВременноеХранилище(НовыйФайлКартинки.Файл.Получить());
	
	Объект.Фото = НовыйФайлКартинки.Ссылка;
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
		Фото = ПолучитьНавигационнуюСсылку(Объект.Фото, "Файл");
КонецПроцедуры
 

&НаКлиенте
Функция СоздатьУведомление(Заголовок, Текст, Данные = 0, ДатаСрабатывания, ИнтервалПовторения = 0)
    Уведомление = Новый ДоставляемоеУведомление;
    Уведомление.Заголовок = Заголовок;
    Уведомление.Текст = Текст;
    Уведомление.Данные = Данные;
    Уведомление.ДатаПоявленияУниверсальноеВремя = ДатаСрабатывания;
    Уведомление.ИнтервалПовтора = ИнтервалПовторения;
    Уведомление.ЗвуковоеОповещение = ЗвуковоеОповещение.ПоУмолчанию;
    Возврат Уведомление;
КонецФункции
&НаКлиенте
Процедура ВключитьНапоминание(Команда)
    Уведомление = СоздатьУведомление("Заголовок", "Текст", 2014, '00010101');
    ДоставляемыеУведомления.ДобавитьЛокальноеУведомление(Уведомление);
КонецПроцедуры



